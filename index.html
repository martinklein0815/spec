<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <title>
            ResourceSync Sitemap-based Approach
        </title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link rel="stylesheet" type="text/css" href="resync.css" media="screen, projection" />
        <meta name="robots" content="all" />
    </head>
    <body>
        <p>
            <a name="top" id="top"></a>
        </p>
        <div id="mainContent">
            <h1>
                <a name="resync_protocol" id="resync_protocol"></a>ResourceSync Sitemap-based Approach
            </h1>
            <!-- TOC -->
            <blockquote>
                <b>Jump to:</b><br />
                <a href="#definitions">1. Definitions</a><br />
                <a href="#baseline_sync">2. Baseline Synchronization</a><br />
                <a href="#source_capability">3. Source Capabilities Description</a><br />
                <a href="#change_communication">4. Change Communication</a><br />
                <a href="#dump_packaging">5. Dump Packaging</a><br />
                <a href="#resource_transfer_override">6. Resource Transfer Override</a><br />
            </blockquote>
            
            <!-- Intro -->
            <p>
                ResourceSync is a synchronization framework for Web resources. It allows a <em>Destination</em> to keep in sync with resource changes in a <em>Source</em>.
                
                This document describes the XML Schemas for the ResourceSync components and the messages that are exchanged between Source and Destination.
            </p>
            <br />
            <br />
            <br />
            <br />
            
            <!-- DEFINITIONS -->
            <h2>
                <a name="definitions" id="definitions"></a>1. Definitions
            </h2>
            <ul>
            <li><strong>Resource</strong>: an object to be synchronized, a web resource <span class="todo"> identified by a de-referencable URI?</span></li>

            <li><strong>Metadata</strong>: information about Resources such as URI, modification time,
               checksum, etc. (Not to be confused with Resources that may
               themselves be metadata about another resource, e.g. a DC record)</li>

            <li><strong>Source</strong>: system with original or master Resource</li>

            <li><strong>Destination</strong>: system to which Resources from the Source will be
               copied and kept in synchronization</li>

            <li><strong>Pull</strong>: process to get information from Source to Destination initiated
               by the Destination.</li>

            <li><strong>Push</strong>: process to get information from Source to Destination initiated
               by the Source.</li>
            </ul>
            
            <p>Three distinct needs considered in scope for the effort:</p>
            <ol>
                <li><strong>Baseline Synchronization</strong>: Allows a Destination to perform an
                   initial synchronization with a Source. (We consider only Pull
                   methods in scope.)</li>
               <li><strong>Incremental Synchronization</strong>: Allows a Destination to remain
                  synchronized with the Source by following changes at the
                  Source. Two aspects:</li>
                <ol type="a">
                    <li><strong>Change Communication</strong>: Allows a Destination to understand that a
                        Resource has changed; and what the nature of that change event
                        is.</li>
                    <li><strong>Resource Transfer</strong>: Allows a Destination to update its holdings to
                            reflect a change in a Resource at the Source.</li>
                </ol>
                <li><strong>Audit</strong>: Allow checking whether a Destination is in synchronization
                   with a Source. (We consider only Pull methods in scope.)</li>
            </ol>
            
            <p>Additional terminology/concepts:</p>

            <ul>
                <li><strong>Change Memory</strong>: A record of changes, perhaps as ChangeSets</li>

                <li><strong>Resource Memory</strong>: A record or archive of past Resource states</li>

                <li><strong>ChangeSet</strong>: a set of events used for Change Communication</li>

                <li><strong>Dump</strong>: a package of Resources and associated Metadata</li>

                <li><strong>Pull based Incremental Synchronization</strong>: method of Incremental
               Synchronization relying on polling by the Destination.</li>

                <li><strong>Push based Incremental Synchronization</strong>: method of Incremental
               Synchronization relying on changes being pushed from the Source to
               the Destination, likely via an intermediary.</li>
            </ul>
            
            <!-- INVENTORY -->
            <h2>
                <a name="baseline_sync" id="baseline_sync"></a>2. Baseline Synchronization
            </h2>
            <p>To allow a Destination to perform an initial synchronization with a Source, it needs to retrieve the list of Resources available in a Source, its <strong>Inventory</strong>.</p>
                
            <p>A Source generates an <a href="http://www.sitemaps.org/" title="sitemaps.org - Home">XML Sitemap</a> to describe its Inventory. All data values in a Sitemap must be <a href="http://www.sitemaps.org/protocol.html#escaping">entity-escaped</a>. The Sitemap serialization must be UTF-8 encoded.</p>
            <p>
                The Sitemap must:
            </p>
            <ul>
                <li>Begin with an opening <code>&lt;<a href="#urlsetdef">urlset</a>&gt;</code> tag and end with a closing <code>&lt;/urlset&gt;</code> tag.
                </li>
                <li>Specify the namespace (protocol standard) within the <code>&lt;urlset&gt;</code> tag.
                </li>
                <li>Include a <code>&lt;<a href="#urldef">url</a>&gt;</code> entry for each URL <span class="rs">(resource)</span>, as a parent XML tag.    </li>
                <li>Include a <code>&lt;<a href="#locdef">loc</a>&gt;</code> child entry for each <code>&lt;url&gt;</code> parent tag.</li>
                <li><span class="rs">Include a <code>&lt;<a href="#lastmod">lastmod</a>&gt;</code> child entry for each <code>&lt;url&gt;</code> parent tag in order to enable baseline synchronization.</span> <span class="todo">Should this be mandatory for ResourceSync?</span>
            </ul>
            
            <p>
                Elements introduced for ResourceSync are in the <code class="rs">http://resourcesync.org/ns/</code> namespace. The <code class="rs">rs</code> prefix is used in this document to indicate that XML tags are defined in that namespace.
            </p>

            <h3>
                2.1 Sample XML Sitemap Inventory
            </h3>
            <p>
                The following example shows a Sitemap inventory using just the minimum required tags for resource synchronization.
            </p>
<pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;<a href="#urlsetdef">urlset</a> xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"&gt;
   &lt;<a href="#urldef">url</a>&gt;
      &lt;<a href="#locdef">loc</a>&gt;http://www.example.com/res1&lt;/loc&gt;
      &lt;<a href="#lastmoddef">lastmod</a>&gt;2005-01-01&lt;/lastmod&gt;
   &lt;/url&gt;
&lt;/urlset&gt; 
</pre>
            <p>
                The following example shows a Sitemap inventory that contains just one URL and uses all optional tags. The optional tags are in italics.
            </p>
            <pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;<a href="#urlsetdef">urlset</a> xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
        <span class="rs">xmlns:rs="http://resourcesync.org/ns/"</span>&gt;
   &lt;<a href="#urldef">url</a>&gt;
      &lt;<a href="#locdef">loc</a>&gt;http://www.example.com/res1&lt;/loc&gt;
      &lt;<a href="#lastmoddef">lastmod</a>&gt;2005-01-01&lt;/lastmod&gt;
      <em>&lt;<span class="rs"><a href="#sizedef">rs:size</a>&gt;5746&lt;/rs:size&gt;</span>
      &lt;<span class="rs"><a href="#md5def">rs:md5</a>&gt;4bcf598d44af505bab359b0eedd67114&lt;/rs:md5&gt;</span>
      &lt;<span class="rs"><a href="#tagdef">rs:tag</a>&gt;frogs&lt;/rs:tag&gt;</span>
      &lt;<a href="#changefreqdef">changefreq</a>&gt;monthly&lt;/changefreq&gt;
      &lt;<a href="#prioritydef">priority</a>&gt;0.8&lt;/priority&gt;</em>
   &lt;/url&gt;
&lt;/urlset&gt; 
</pre>

            <h3>
                <a name="xmlTagDefinitions" id="xmlTagDefinitions"></a>2.2 XML tag definitions
            </h3>
            <p>
                The available XML tags are described below.
            </p>
            <table width="80%">
                <tr>
                    <th>
                        Attribute
                    </th>
                    <th></th>
                    <th>
                        Description
                    </th>
                </tr>
                <tr>
                    <td>
                        <a name="urlsetdef" id="urlsetdef"></a><code>&lt;urlset&gt;</code>
                    </td>
                    <td>
                        required
                    </td>
                    <td>
                        <p>
                            Encapsulates the file and references the current XML Sitemap <span class="rs">protocol standard</span>.
                        </p>
                    </td>
                </tr>
                <tr class="alt">
                    <td>
                        <a name="urldef" id="urldef"></a><code>&lt;url&gt;</code>
                    </td>
                    <td>
                        required
                    </td>
                    <td>
                        <p>
                            Parent tag for each URL entry. The remaining tags are children of this tag.
                        </p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <a name="locdef" id="locdef"></a><code>&lt;loc&gt;</code>
                    </td>
                    <td>
                        required
                    </td>
                    <td>
                        <p>
                            URL of the page. This URL must begin with the protocol (such as http) and end with a trailing slash, if your web server requires it. This value must be less than 2,048 characters.
                        </p>
                    </td>
                </tr>
                <tr class="alt">
                    <td>
                        <a name="lastmoddef" id="lastmoddef"></a><code>&lt;lastmod&gt;</code>
                    </td>
                    <td>
                        optional <span class="todo">required?</span>
                    </td>
                    <td>
                        <p>
                            The date of last modification of the file. This date should be in <a href="http://www.w3.org/TR/NOTE-datetime">W3C Datetime</a> format. This format allows you to omit the time portion, if desired, and use YYYY-MM-DD.
                        </p>
                        <p>
                            Note that this tag is separate from the If-Modified-Since (304) header the server can return, and search engines may use the information from both sources differently.
                        </p>
                    </td>
                </tr>
                <tr class="rs">
                    <td>
                        <a name="sizedef" id="sizedef"></a><code>&lt;rs:size&gt;</code>
                    </td>
                    <td>
                        optional
                    </td>
                    <td>
                        <p>
                            The size in bytes of the resource.
                        </p>
                    </td>
                </tr>
                <tr class="alt rs">
                    <td>
                        <a name="md5def" id="md5def"></a><code>&lt;rs:md5&gt;</code>
                    </td>
                    <td>
                        optional
                    </td>
                    <td>
                        <p>
                            The MD5 checksum for the resource expressed in hex, e.g. <code>4415d4a1df0e4bee731db465b04da138</code>.
                        </p>
                    </td>
                </tr>
                <tr class="rs">
                    <td>
                        <a name="tagdef" id="tagdef"></a><code>&lt;rs:tag&gt;</code>
                    </td>
                    <td>
                        optional, repeatable
                    </td>
                    <td>
                        <p>
                            A keyword or term assigned to a resource, which may originate from existing controlled vocabularies. This element may be repeated to indicate multiple tags. A destination can use this element for selective synchronization. <span class="todo">TODO: use dc:subject instead? Simeon - think no, because dc:subject has semantics that may not match the reason for giving tags. I like rs:tag.</span>
                        </p>
                    </td>
                </tr>
                <tr class="alt">
                    <td>
                        <a name="changefreqdef" id="changefreqdef"></a><code>&lt;changefreq&gt;</code>
                    </td>
                    <td>
                        optional
                    </td>
                    <td>
                        <p>
                            How frequently the page is likely to change. This value provides general information to search engines and may not correlate exactly to how often they crawl the page. Valid values are:
                        </p>
                        <ul>
                            <li>always
                            </li>
                            <li>hourly
                            </li>
                            <li>daily
                            </li>
                            <li>weekly
                            </li>
                            <li>monthly
                            </li>
                            <li>yearly
                            </li>
                            <li>never
                            </li>
                        </ul>
                        <p>
                            The value "always" should be used to describe documents that change each time they are accessed. The value "never" should be used to describe archived URLs.
                        </p>
                        <p>
                            Please note that the value of this tag is considered a <i>hint</i> and not a command. Even though search engine crawlers may consider this information when making decisions, they may crawl pages marked "hourly" less frequently than that, and they may crawl pages marked "yearly" more frequently than that. Crawlers may periodically crawl pages marked "never" so that they can handle unexpected changes to those pages.
                        </p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <a name="prioritydef" id="prioritydef"></a><code>&lt;priority&gt;</code>
                    </td>
                    <td>
                        optional
                    </td>
                    <td>
                        <p>
                            The priority of this URL relative to other URLs on your site. Valid values range from 0.0 to 1.0. This value does not affect how your pages are compared to pages on other sites—it only lets the search engines know which pages you deem most important for the crawlers.
                        </p>
                        <p>
                            The default priority of a page is 0.5.
                        </p>
                        <p>
                            Please note that the priority you assign to a page is not likely to influence the position of your URLs in a search engine's result pages. Search engines may use this information when selecting between URLs on the same site, so you can use this tag to increase the likelihood that your most important pages are present in a search index.
                        </p>
                        <p>
                            Also, please note that assigning a high priority to all of the URLs on your site is not likely to help you. Since the priority is relative, it is only used to select between URLs on your site.
                        </p>
                    </td>
                </tr>
            </table>
            <h3>
                <a name="sitemapXMLExample" id="sitemapXMLExample"></a>2.3 Sample XML Sitemap
            </h3>
            <p>
                The following example shows a Sitemap in XML format. The Sitemap in the example contains a small number of URLs.
            </p>
<pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;<a href="#urlsetdef">urlset</a> xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
        <span class="rs">xmlns:rs="http://resourcesync.org/ns/"</span>&gt;
   &lt;<a href="#urldef">url</a>&gt;
      &lt;<a href="#locdef">loc</a>&gt;http://www.example.com/res1&lt;/loc&gt;
      &lt;<a href="#lastmoddef">lastmod</a>&gt;2005-01-01&lt;/lastmod&gt;
      &lt;<span class="rs"><a href="#tagdef">rs:tag</a>&gt;frogs&lt;/rs:tag&gt;</span>      
      &lt;<span class="rs"><a href="#tagdef">rs:tag</a>&gt;crocodiles&lt;/rs:tag&gt;</span>
   &lt;/url&gt;
   &lt;<a href="#urldef">url</a>&gt;
      &lt;<a href="#locdef">loc</a>&gt;http://www.example.com/res2&lt;/loc&gt;
      &lt;<a href="#lastmoddef">lastmod</a>&gt;2006-02-21T18:00:15+00:00&lt;/lastmod&gt;
      &lt;<span class="rs"><a href="#tagdef">rs:tag</a>&gt;fish&lt;/rs:tag&gt;</span>
   &lt;/url&gt;
   &lt;<a href="#urldef">url</a>&gt;
      &lt;<a href="#locdef">loc</a>&gt;http://www.example.com/res3&lt;/loc&gt;
      &lt;<a href="#lastmoddef">lastmod</a>&gt;2007-03-23T18:00:15+00:00&lt;/lastmod&gt;
      &lt;<span class="rs"><a href="#tagdef">rs:tag</a>&gt;humans&lt;/rs:tag&gt;</span>
   &lt;/url&gt;
&lt;/urlset&gt;
</pre>
            <h3>
                <a name="sitemap_index_inventory" id="sitemap_index_inventory"></a>2.4 Sitemap Index Inventory (to group multiple Sitemap files)
            </h3>
            <p>
                You can provide multiple Sitemap files, but each Sitemap file that you provide must have no more than 50,000 URLs and must be no larger than 10MB (10,485,760 bytes). If you would like, you may compress your Sitemap files using gzip to reduce your bandwidth requirement; however the Sitemap file once uncompressed must be no larger than 10MB. If you want to list more than 50,000 URLs, you must create multiple Sitemap files.
            </p>
            <p>
                If you do provide multiple Sitemaps, you should then list each Sitemap file in a Sitemap index file. Sitemap index files may not list more than 50,000 Sitemaps and must be no larger than 10MB (10,485,760 bytes) and can be compressed. You can have more than one Sitemap index file. The XML format of a Sitemap index file is very similar to the XML format of a Sitemap file.
            </p>
            <p class="todo">
                The Sitemaps specification results in a limit of 2.5 billion (2.5x10<sup>9</sup>) resources if the Sitemap limits are followed (and up to 500GB for all the Sitemap files). If necessary, strategies for extension might include relaxation of the size/entry limits of individual Sitemap and Sitemap index files, or extension to three (or more) tiers where a Sitemap index may specify a set of Sitemap indexes (with three levels one could then support 125 trillion (1.25x10<sup>14</sup>) resources and the Sitemaps alone would be extremely large, up to 25PB).
            </p>
            
            <p>
                The Sitemap index file must:
            </p>
            <ul>
                <li>Begin with an opening <code>&lt;<a href="#sitemapIndex_sitemapindex">sitemapindex</a>&gt;</code> tag and end with a closing <code>&lt;/sitemapindex&gt;</code> tag.
                </li>
                <li>Include a <code>&lt;<a href="#sitemapIndex_sitemap">sitemap</a>&gt;</code> entry for each Sitemap as a parent XML tag.
                </li>
                <li>Include a <code>&lt;<a href="#sitemapIndex_loc">loc</a>&gt;</code> child entry for each <code>&lt;sitemap&gt;</code> parent tag.
                </li>
            </ul>
            <p>
                The <code>&lt;<a href="#sitemapIndex_lastmod">lastmod</a>&gt;</code> and <span class="rs"><code>&lt;<a href="#sitemapIndex_tag">rs:tag</a>&gt;</code></span> elements are optional Sitemap index files.
            </p>
            <p>
                <strong>Note:</strong> A Sitemap index file can only specify Sitemaps that are found on the same site as the Sitemap index file. For example, http://www.yoursite.com/sitemap_index.xml can include Sitemaps on http://www.yoursite.com but not on http://www.example.com or http://yourhost.yoursite.com. As with Sitemaps, your Sitemap index file must be UTF-8 encoded.
            </p>
            
            <h3>
                <a name="sitemapIndexXMLExample" id="sitemapIndexXMLExample"></a>2.5 Sample XML Sitemap Index
            </h3>
            <p>
                The following example shows a Sitemap index that lists two Sitemaps:
            </p>
            <pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;<a href="#sitemapIndex_sitemapindex">sitemapindex</a> xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
        <span class="rs">xmlns:rs="http://resourcesync.org/ns/"</span>&gt;
   &lt;<a href="#sitemapIndex_sitemap">sitemap</a>&gt;
      &lt;<a href="#sitemapIndex_loc">loc</a>&gt;http://www.example.com/sitemap1.xml.gz&lt;/loc&gt;
      &lt;<a href="#sitemapIndex_lastmod">lastmod</a>&gt;2012-10-01T18:23:17+00:00&lt;/lastmod&gt;
      &lt;<span class="rs"><a href="#tagdef">rs:tag</a>&gt;frogs&lt;/rs:tag&gt;</span>
      &lt;<span class="rs"><a href="#tagdef">rs:tag</a>&gt;crocodiles&lt;/rs:tag&gt;</span>
      &lt;<span class="rs"><a href="#tagdef">rs:tag</a>&gt;fish&lt;/rs:tag&gt;</span>
   &lt;/sitemap&gt;
   &lt;<a href="#sitemapIndex_sitemap">sitemap</a>&gt;
      &lt;<a href="#sitemapIndex_loc">loc</a>&gt;http://www.example.com/sitemap2.xml.gz&lt;/loc&gt;
      &lt;<a href="#sitemapIndex_lastmod">lastmod</a>&gt;2012-01-01&lt;/lastmod&gt;
      &lt;<span class="rs"><a href="#tagdef">rs:tag</a>&gt;humans&lt;/rs:tag&gt;</span>
   &lt;/sitemap&gt;
&lt;/sitemapindex&gt;
</pre>
            <p>
                <strong>Note:</strong> Sitemap URLs, like all values in your XML files, must be <a href="#escaping">entity escaped</a>.
            </p>
            <h3>
                <a name="sitemapIndexTagDefinitions" id="sitemapIndexTagDefinitions"></a>2.6 Sitemap Index XML Tag Definitions
            </h3>
            <table width="80%">
                <tr>
                    <th>
                        Attribute
                    </th>
                    <th></th>
                    <th>
                        Description
                    </th>
                </tr>
                <tr>
                    <td>
                        <a name="sitemapIndex_sitemapindex" id="sitemapIndex_sitemapindex"></a><code>&lt;sitemapindex&gt;</code>
                    </td>
                    <td>
                        required
                    </td>
                    <td>
                        Encapsulates information about all of the Sitemaps in the file.
                    </td>
                </tr>
                <tr class="alt">
                    <td>
                        <a name="sitemapIndex_sitemap" id="sitemapIndex_sitemap"></a><code>&lt;sitemap&gt;</code>
                    </td>
                    <td>
                        required
                    </td>
                    <td>
                        Encapsulates information about an individual Sitemap.
                    </td>
                </tr>
                <tr>
                    <td>
                        <a name="sitemapIndex_loc" id="sitemapIndex_loc"></a><code>&lt;loc&gt;</code>
                    </td>
                    <td>
                        required
                    </td>
                    <td>
                        <p>
                            Identifies the location of the Sitemap.
                        </p>
                        <p>
                            This location can be a Sitemap, an Atom file, RSS file or a simple text file.
                        </p>
                    </td>
                </tr>
                <tr class="alt">
                    <td>
                        <a name="sitemapIndex_lastmod" id="sitemapIndex_lastmod"></a><code>&lt;lastmod&gt;</code>
                    </td>
                    <td>
                        optional
                    </td>
                    <td>
                        <p>
                            Identifies the time that the corresponding Sitemap file was modified. It does not correspond to the time that any of the pages listed in that Sitemap were changed. The value for the lastmod tag should be in <a href="http://www.w3.org/TR/NOTE-datetime">W3C Datetime</a> format.
                        </p>
                        <p>
                            By providing the last modification timestamp, you enable search engine crawlers to retrieve only a subset of the Sitemaps in the index i.e. a crawler may only retrieve Sitemaps that were modified since a certain date. This incremental Sitemap fetching mechanism allows for the rapid discovery of new URLs on very large sites.
                        </p>
                    </td>
                </tr>
                <tr class="rs">
                    <td>
                        <a name="sitemapIndex_tag" id="sitemapIndex_tag"></a><code>&lt;rs:tag&gt;</code>
                    </td>
                    <td>
                        optional
                    </td>
                    <td>
                        <p>
                            A keyword or term assigned to a Sitemap. This terms is aggregated from the resources' tags within a Sitemap. This element may be repeated to indicate multiple tags. A destination can use this element for selective synchronization. TODO: use dc:subject instead?
                        </p>
                        <p>
                            By providing tags clients can retrieve only a subset of available Sitemap index files.
                        </p>
                    </td>
                </tr>
                
            </table>

            <p class="backtotop">
                <a href="#top">Back to top</a>
            </p>
            
            
            <!-- INVENTORY - COMPONENT DISCOVERY -->
            <h2>
                <a name="source_capability" id="source_capability"></a>3. Source Capabilities Description
            </h2>
            
            <p>ResourceSync proposes a <strong>modular</strong> synchronization framework, consisting of several components. The availability of these components depends on a Source's capabilities. A Source can describe its capabilities by providing links to available synchronization components. <span class="todo">TODO: more details on this!</span></p>
            
            
            <h3>
                <a name="dump_discovery" id="dump_discovery"></a>3.1 Dump Discovery
            </h3>
            
            <p>A source may periodically produce Dumps, which are packages of Resources and associated Metadata. It gives a Destination the opportunity to obtain the resource content without having to pull all resources separately via HTTP GET requests. A Source can indicate the availability of Dumps by providing links to downloadable dump files in its Sitemap inventory.</p>

<pre>
&lt;urlset xmlns=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;
        xmlns:rs=&quot;http://resourcesync.org/ns/&quot;
        xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot;&gt;
<span class="rs">
    &lt;!-- the source produces resource dumps --&gt;
    &lt;atom:link href=&quot;http://example.com/dump/dump1.tar.gz&quot; rel=&quot;rs:dump&quot; rs:tags=&quot;crocodiles frogs&quot;/&gt;
    &lt;atom:link href=&quot;http://example.com/dump/dump2.tar.gz&quot; rel=&quot;rs:dump&quot; rs:tags=&quot;fish&quot;/&gt;
    &lt;atom:link href=&quot;http://example.com/dump/dump2.tar.gz&quot; rel=&quot;rs:dump&quot; rs:tags=&quot;humans&quot;/&gt;
</span>
    &lt;url&gt;
       &lt;loc&gt;http://www.example.com/res1&lt;/loc&gt;
       &lt;lastmod&gt;2005-01-01&lt;/lastmod&gt;
       &lt;rs:tag&gt;frogs&lt;/rs:tag&gt;      
       &lt;rs:tag&gt;crocodiles&lt;/rs:tag&gt;
    &lt;/url&gt;
    &lt;url&gt;
       &lt;loc&gt;http://www.example.com/res2&lt;/loc&gt;
       &lt;lastmod&gt;2006-02-21T18:00:15+00:00&lt;/lastmod&gt;
       &lt;rs:tag&gt;fish&lt;/rs:tag&gt;
    &lt;/url&gt;
    &lt;url&gt;
       &lt;loc&gt;http://www.example.com/res3&lt;/loc&gt;
       &lt;lastmod&gt;2007-03-23T18:00:15+00:00&lt;/lastmod&gt;
       &lt;rs:tag&gt;humans&lt;/rs:tag&gt;
    &lt;/url&gt;
&lt;/urlset&gt;
</pre>

<p class="todo">
   Open Issue: Should we conflate tags into a single rs:tags element?  Simeon - I think that separate elements is best (with attributes one has to do it though).
</p>

            <h3>
                <a name="change_comm_discovery_pull" id="change_comm_discovery_pull"></a>3.2 Pull-based Change Communication Discovery
            </h3>

            <p>Pull-based Incremental Synchronization relies on changes being polled by the Destination. Therefore, a Source may provide links to relevant ChangeSets in a Change Memory, which may be hosted by the Source itself or an external Change Memory service. A ChangeSet is identified by a de-referencable URI and contains an entry for each change event that occurred on a Source's resources <strong>after</strong> the creation of the inventory, i.e, the Sitemap serialization.</p>
            
            <p>ChangeSets can be static dumps (e.g., files on a Web server)...</p>

<pre>
&lt;urlset xmlns=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;
    xmlns:rs=&quot;http://resourcesync.org/ns/&quot;
    xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot;&gt;

<span class="rs">   &lt;!-- Static changeset file --&gt;
   &lt;atom:link href=&quot;http://example.com/changes/changeset.xml&quot; rel=&quot;rs:changeset&quot;/&gt;</span>

   &lt;url&gt;...&lt;/url&gt;

   &lt;url&gt;...&lt;/url&gt;

&lt;/urlset&gt;
</pre>

<p>...or dynamically generated Web resources (e.g., DB-backed Change Memory).</p>

<pre>
&lt;urlset xmlns=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;
    xmlns:rs=&quot;http://resourcesync.org/ns/&quot;
    xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot;&gt;

<span class="rs">   &lt;!-- Dynamically generated changeset  --&gt;
   &lt;atom:link href=&quot;http://example.com/changes/20/diff&quot; rel=&quot;rs:changeset&quot;/&gt;</span>

   &lt;url&gt;...&lt;/url&gt;

   &lt;url&gt;...&lt;/url&gt;

&lt;/urlset&gt;
</pre>

            <h3>
                <a name="change_comm_discovery_push" id="change_comm_discovery_push"></a>3.3 Push-based Change Communication Discovery
            </h3>

            <p>Push-based Incremental Synchronization relies on changes being pushed from the Source to the Destination, likely via an intermediary notification service. Therefore, a Source may provide links to (an) intermediary notification service(s) a Destination can subscribe to.</p>
            

<pre>
&lt;urlset xmlns=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;
    xmlns:rs=&quot;http://resourcesync.org/ns/&quot;
    xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot;&gt;

<span class="rs">    &lt;!-- The intermediary notification service --&gt; 
    &lt;atom:link href=&quot;xmpp:pubsub.example.org/&quot; rel=&quot;rs:notification&quot; rs:profile=&quot;&lt;http://xmpp.org/extensions/xep-0060.html&gt;&quot; rs:pubsubnode=&quot;All&quot;/&gt;</span>

    &lt;url&gt;...&lt;/url&gt;

    &lt;url&gt;...&lt;/url&gt;

&lt;/urlset&gt;
</pre>

<p>Push- and Pull-based Incremental Synchronization can be combined. A Source can indicate the availability of an intermediary notification service and a Change Memory service. A Destination can subscribe to the notification service and eventually catch up with change events by polling the Change Memory.</p>

<pre>
&lt;urlset xmlns=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;
    xmlns:rs=&quot;http://resourcesync.org/ns/&quot;
    xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot;&gt;

<span class="rs">   &lt;!-- The used change notification transport protocol --&gt; 
   &lt;atom:link href=&quot;xmpp:pubsub.example.org/&quot; rel=&quot;rs:notification&quot; rs:profile=&quot;&lt;http://xmpp.org/extensions/xep-0060.html&gt;&quot; rs:pubsubnode=&quot;All&quot;/&gt;
   &lt;!-- The change memory for polling changes --&gt;
   &lt;atom:link href=&quot;http://example.com/changes/changeset.xml&quot; rel=&quot;rs:changeset&quot;/&gt;</span>

   &lt;url&gt;...&lt;/url&gt;

   &lt;url&gt;...&lt;/url&gt;

&lt;/urlset&gt;
</pre>            

            <h3>
                <a name="resource_memory_discovery_memento" id="resource_memory_discovery_memento"></a>3.4 Resource Memory Discovery (via Memento)
            </h3>
            
            <p>A Source can indicate the availability of archived or past resource states by providing links to Memento TimeGates <span class="todo">TODO: link!</span>.</p>
            
<pre>            
&lt;urlset xmlns=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;
    xmlns:rs=&quot;http://resourcesync.org/ns/&quot;
    xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot;&gt;

    &lt;url&gt;
       &lt;loc&gt;http://www.example.com/res1&lt;/loc&gt;
       &lt;lastmod&gt;2005-01-01&lt;/lastmod&gt;
       &lt;rs:tag&gt;frogs&lt;/rs:tag&gt;      
       &lt;rs:tag&gt;crocodiles&lt;/rs:tag&gt;
<span class="rs">       &lt;atom:link href=&quot;http://example.com/timegate/http://www.example.com/res1&quot; rel=&quot;timegate&quot;/&gt;</span>
    &lt;/url&gt;
    &lt;url&gt;
       &lt;loc&gt;http://www.example.com/res2&lt;/loc&gt;
       &lt;lastmod&gt;2006-02-21T18:00:15+00:00&lt;/lastmod&gt;
       &lt;rs:tag&gt;fish&lt;/rs:tag&gt;
<span class="rs">       &lt;atom:link href=&quot;http://example.com/timegate/http://www.example.com/res2&quot; rel=&quot;timegate&quot;/&gt;</span>
    &lt;/url&gt;
    &lt;url&gt;
       &lt;loc&gt;http://www.example.com/res3&lt;/loc&gt;
       &lt;lastmod&gt;2007-03-23T18:00:15+00:00&lt;/lastmod&gt;
       &lt;rs:tag&gt;humans&lt;/rs:tag&gt;
<span class="rs">       &lt;atom:link href=&quot;http://example.com/timegate/http://www.example.com/res3&quot; rel=&quot;timegate&quot;/&gt;</span>
    &lt;/url&gt;   

&lt;/urlset&gt;
</pre>
            
            <h3>
                <a name="resource_memory_discovery_versioning" id="resource_memory_discovery_versioning"></a>3.5 Resource Memory Discovery (via Resource version URIs)
            </h3>
            
            <p>A Source can indicate the availability of archived or past resource states by providing Resource version URIs (e.g., as in Wikipedia).</p>
<pre>
&lt;urlset xmlns=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;
        xmlns:rs=&quot;http://resourcesync.org/ns/&quot;&gt;

    &lt;url&gt;
       &lt;loc&gt;http://www.example.com/res1&lt;/loc&gt;
       &lt;lastmod&gt;2005-01-01&lt;/lastmod&gt;
       &lt;rs:tag&gt;frogs&lt;/rs:tag&gt;      
       &lt;rs:tag&gt;crocodiles&lt;/rs:tag&gt;
<span class="rs">       &lt;atom:link href=&quot;http://example.com/5/res1&quot; rel=&quot;self&quot;/&gt;</span>
    &lt;/url&gt;
    &lt;url&gt;
       &lt;loc&gt;http://www.example.com/res2&lt;/loc&gt;
       &lt;lastmod&gt;2006-02-21T18:00:15+00:00&lt;/lastmod&gt;
       &lt;rs:tag&gt;fish&lt;/rs:tag&gt;
<span class="rs">       &lt;atom:link href=&quot;http://example.com/10/res2&quot; rel=&quot;self&quot;/&gt;</span>
    &lt;/url&gt;
    &lt;url&gt;
       &lt;loc&gt;http://www.example.com/res3&lt;/loc&gt;
       &lt;lastmod&gt;2007-03-23T18:00:15+00:00&lt;/lastmod&gt;
       &lt;rs:tag&gt;humans&lt;/rs:tag&gt;
<span class="rs">       &lt;atom:link href=&quot;http://example.com/3/res3&quot; rel=&quot;self&quot;/&gt;</span>
    &lt;/url&gt;   

&lt;/urlset&gt;
</pre>            
<p class="backtotop">
    <a href="#top">Back to top</a>
</p>

        <!-- CHANGE COMMUNICATION -->
        <h2>
            <a name="change_communication" id="change_communication"></a>4. Change Communication
        </h2>

        <p>Change Communication allows a Destination to understand that a Resource has changed in the Source; and what the nature of that change event is. Change events can either be polled from a Change Memory by a Destination or pushed from a Source to a Destination via some intermediary notification mechanism.</p>
            
        <h3>4.1 Pull-based Change Communication</h3>
        
        <p>A ChangeMemory records change events and allows Destinations to poll for change events. As a response, the Destination receives a ChangeSet, which can contain a (possibly empty) set of change events. Each event has an event identifier, which allows a Destination to identify already known change events.</p>
        
        <p>A <strong>Dynamic ChangeMemory</strong> can be implemented as a RESTful Web application (probably backed by some RDBMS), which allows ChangeSets to be constructed and retrieved dynamically. From a Source's inventory (the Sitemap) a Destination retrieves a link to ChangeSet (e.g., http://example.com/changes/22/diff), which contains all change events that have occurred after retrieving the inventory. In the example below, two events have occurred since the Destination retrieved the Sitemap. The Destination also obtains a link to the "next" ChangeSet, which can contain later change events or be empty if no changes have occurred in between. This mechanism requires that the Source assigns sequential identifiers to change events (rs:eventid), considering their natural temporal order. If a Destination remembers the "next" ChangeSet URI (e.g., http://example.com/changes/22/diff) it retrieves with each ChangeSet response, it can efficiently poll for the changes it hasn't seen yet and incrementally synchronize Resources. Event identifiers can be dereferencable Web resources or sequential numeric values.</p>

<pre>
&lt;changeset xmlns:rs=&quot;http://resourcesync.org/ns/&quot;
    xmlns:sm=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;
    xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot;
    xmlns:dc=&quot;http://purl.org/dc/terms/&quot;&gt;

<span class="rs">    &lt;atom:link href=&quot;http://example.com/changes/20/diff&quot; rel=&quot;self rs:changeset&quot;/&gt;
    &lt;atom:link href=&quot;http://example.com/changes/22/diff&quot; rel=&quot;next rs:changeset&quot;/&gt;</span>

    &lt;sm:url&gt;
<span class="rs">       &lt;rs:eventid&gt;http://example.com/changes/21&lt;/rs:eventid&gt;</span>
       &lt;sm:loc&gt;http://www.example.com/res1&lt;/sm:loc&gt;
       &lt;sm:lastmod&gt;2012-05-30&lt;/sm:lastmod&gt;
       &lt;rs:tag&gt;frogs&lt;/rs:tag&gt;      
       &lt;rs:tag&gt;crocodiles&lt;/rs:tag&gt;
<span class="rs">       &lt;rs:eventtype&gt;updated&lt;/rs:eventtype&gt;
       &lt;dc:publisher&gt;http://example.com&lt;/dc:publisher&gt; &lt;!-- optional --&gt;</span>
    &lt;/sm:url&gt;
    &lt;sm:url&gt;
<span class="rs">       &lt;rs:eventid&gt;http://example.com/changes/22&lt;/rs:eventid&gt;</span>     
       &lt;sm:loc&gt;http://www.example.com/res4&lt;/sm:loc&gt;
       &lt;sm:lastmod&gt;2012-05-31&lt;/sm:lastmod&gt;
       &lt;rs:tag&gt;elephants&lt;/rs:tag&gt;
<span class="rs">       &lt;rs:eventtype&gt;created&lt;/rs:eventtype&gt;
       &lt;dc:publisher&gt;http://example.com&lt;/dc:publisher&gt; &lt;!-- optional --&gt;</span>
    &lt;/sm:url&gt;
&lt;/changeset&gt;
</pre>   
        
        <p>A <strong>Static Change Memory</strong> can serialize ChangeSets into static files and place them into some Web-accessible directory. The Source can use the link in the Sitemap to retrieve the relevant ChangeSet (e.g., changeset2.xml). If ChangeSets files are linked with each other, the Destination can walk through these files entry by entry. A Destination can also retrieve the most recent ("most_recent.xml") changes and walk the list of change events backwards (throughout files) in order to apply the changes as they occurred in the Source.
        </p>
        
<pre>
&lt;changeset xmlns=&quot;http://resourcesync.org/ns/&quot;
        xmlns:rs=&quot;http://resourcesync.org/ns/&quot;
        xmlns:sm=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;
        xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot;&gt;

<span class="rs">    &lt;atom:link href=&quot;http://example.com/changes/changeset2.xml&quot; rel=&quot;self rs:changeset&quot;/&gt;
    &lt;atom:link href=&quot;http://example.com/changes/changeset1.xml&quot; rel=&quot;prev rs:changeset&quot;/&gt;
    &lt;atom:link href=&quot;http://example.com/changes/most_recent.xml&quot; rel=&quot;last rs:changeset&quot;/&gt;</span>

    &lt;sm:url&gt;
<span class="rs">       &lt;rs:eventid&gt;4353dfsgesn431&lt;/rs:eventid&gt;</span>
       &lt;sm:loc&gt;http://www.example.com/res1&lt;/sm:loc&gt;
       &lt;sm:lastmod&gt;2012-05-30&lt;/sm:lastmod&gt;
       &lt;rs:tag&gt;frogs&lt;/rs:tag&gt;      
       &lt;rs:tag&gt;crocodiles&lt;/rs:tag&gt;
<span class="rs">       &lt;rs:eventtype&gt;updated&lt;/rs:eventtype&gt;</span>
<span class="rs">       &lt;dc:publisher&gt;http://example.com&lt;/dc:publisher&gt; &lt;!-- optional --&gt;</span>
    &lt;/sm:url&gt;
    &lt;sm:url&gt;
<span class="rs">       &lt;rs:eventid&gt;sadfn234sfn3f&lt;/rs:eventid&gt;</span>
       &lt;sm:loc&gt;http://www.example.com/res4&lt;/sm:loc&gt;
       &lt;sm:lastmod&gt;2012-05-31&lt;/sm:lastmod&gt;
       &lt;rs:tag&gt;elephants&lt;/rs:tag&gt;
<span class="rs">       &lt;rs:eventtype&gt;created&lt;/rs:eventtype&gt;</span>
<span class="rs">       &lt;dc:publisher&gt;http://example.com&lt;/dc:publisher&gt; &lt;!-- optional --&gt;</span>
    &lt;/sm:url&gt;
&lt;/changeset&gt;
</pre>        

        <p>In both cases, the Destination must follow an initial Change Memory discovery link from the Inventory and then paginate through ChangeSets by following links to previous or next ChangeSets.</p>
        
        <p><span class="todo">Should ChangeSets allow component discovery or should only the Inventory contain discovery links?</span></p>
        
        <h3>4.2 Push-based Change Communication (via XMPP)</h3>
        
        <p>The Source pushes change events via some intermediary (e.g., XMPP) mechanism to the Destination. The intermediary usually packages change events into some kind of message "envelope".</p>
        
<pre>
&lt;message xmlns:rs=&quot;http://resourcesync.org/ns/&quot;
    xmlns:sm=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;&gt;
    &lt;event&gt;
        &lt;items&gt;
            &lt;item id=&quot;12234&quot;&gt;
                &lt;stanza&gt;
                    &lt;!-- payload --&gt;
                    &lt;sm:url&gt;
                        &lt;rs:eventid&gt;4353dfsgesn431&lt;/rs:eventid&gt;
                        &lt;sm:loc&gt;http://www.example.com/res1&lt;/sm:loc&gt;
                        &lt;sm:lastmod&gt;2012-05-30&lt;/sm:lastmod&gt;
                        &lt;rs:tag&gt;frogs&lt;/rs:tag&gt;      
                        &lt;rs:tag&gt;crocodiles&lt;/rs:tag&gt;
                        &lt;rs:eventtype&gt;updated&lt;/rs:eventtype&gt;
                        &lt;dc:publisher&gt;http://example.com&lt;/dc:publisher&gt; &lt;!-- optional --&gt;
                       &lt;!-- publisher info generates a level trust by going after its sitemap and check if notification link is there --&gt;
                    &lt;/sm:url&gt;
                &lt;/stanza&gt;
            &lt;/item&gt;
            &lt;item id=&quot;34456&quot;&gt;
                &lt;stanza&gt;
                &lt;!-- payload --&gt;
                    &lt;sm:url&gt;
                       &lt;rs:eventid&gt;sadfn234sfn3f&lt;/rs:eventid&gt;        
                       &lt;sm:loc&gt;http://www.example.com/res4&lt;/sm:loc&gt;
                       &lt;sm:lastmod&gt;2012-05-31&lt;/sm:lastmod&gt;
                       &lt;rs:tag&gt;elephants&lt;/rs:tag&gt;
                       &lt;rs:eventtype&gt;created&lt;/rs:eventtype&gt;
                       &lt;dc:publisher&gt;http://example.com&lt;/dc:publisher&gt; &lt;!-- optional --&gt;
                    &lt;/sm:url&gt;
                &lt;/stanza&gt;
            &lt;/item&gt;
        &lt;/item&gt;
    &lt;/event&gt;
&lt;/message&gt;
</pre>        

        <h3>4.3 Push-based Change Communication (via simple HTTP Callback)</h3>

        <p>A Source (or its ChangeMemory) can provide a subscription interface, which allows Destinations to register their HTTP Callback URIs. The Source can push ChangeSets to the Destination on a per-event basis or in pre-defined intervals. This functionality can also be outsourced to some intermediary ChangeMemory. The Source would then ping the ChangeMemory whenever change events occur.</p>
        
<pre>

>> Subscription Request <<
POST /subscribe HTTP/1.1
Host: example.com

callbackURI=http://aggregator.org/callback


>> Change Notification <<
POST /callback HTTP/1.1
Host: aggregator.org

&lt;rs:changeset xmlns:rs=&quot;http://resourcesync.org/ns/&quot;
        xmlns:sm=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;&gt;

    &lt;!-- don&#x27;t put any atom links here --&gt;    
    &lt;sm:url&gt;
       &lt;rs:eventid&gt;4353dfsgesn431&lt;/rs:eventid&gt;
       &lt;sm:loc&gt;http://www.example.com/res1&lt;/sm:loc&gt;
       &lt;sm:lastmod&gt;2012-05-30&lt;/sm:lastmod&gt;
       &lt;rs:tag&gt;frogs&lt;/rs:tag&gt;      
       &lt;rs:tag&gt;crocodiles&lt;/rs:tag&gt;
       &lt;rs:eventtype&gt;updated&lt;/rs:eventtype&gt;
       &lt;dc:publisher&gt;http://example.com&lt;/dc:publisher&gt; &lt;!-- optional --&gt;
    &lt;/sm:url&gt;
    &lt;sm:url&gt;
       &lt;rs:eventid&gt;sadfn234sfn3f&lt;/rs:eventid&gt;        
       &lt;sm:loc&gt;http://www.example.com/res4&lt;/sm:loc&gt;
       &lt;sm:lastmod&gt;2012-05-31&lt;/sm:lastmod&gt;
       &lt;rs:tag&gt;elephants&lt;/rs:tag&gt;
       &lt;rs:eventtype&gt;created&lt;/rs:eventtype&gt;
       &lt;dc:publisher&gt;http://example.com&lt;/dc:publisher&gt; &lt;!-- optional --&gt;
    &lt;/sm:url&gt;
&lt;/rs:changeset&gt;
</pre>        

        <p class="backtotop">
            <a href="#top">Back to top</a>
        </p>
        
        
        <!-- DUMP PACKAGING -->
        <h2>
            <a name="dump_packaging" id="dump_packaging"></a>5. Dump Packaging
        </h2>
        
        <p>A Dump packages Resources and associated Metadata of a Source and provides an Sitemap as Dump index file (Manifest). The Manifest (manifest.xml) follows the Inventory's structure but provides an additional pointer (rs:key) to the relative location of the serialized resource within a Dump package (archive).</p>
        
<span class="todo">Q - Simeon - Would remove ./ prefix on rs:key values, I don't think it is of any benefit. Also I wonder whether &lt;rs:path&gt; or even &lt;rs:dumploc&gt; might be a better (more explicit) name.</span>

<pre>
&lt;urlset xmlns=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;
    xmlns:rs=&quot;http://resourcesync.org/ns/&quot;&gt;

    &lt;url&gt;
       &lt;loc&gt;http://www.example.com/res1&lt;/loc&gt;
       &lt;lastmod&gt;2005-01-01&lt;/lastmod&gt;
       &lt;rs:size&gt;5746&lt;/rs:size&gt;
       &lt;rs:md5&gt;4bcf598d44af505bab359b0eedd67114&lt;/rs:md5&gt;
       &lt;rs:tag&gt;frogs&lt;/rs:tag&gt;      
       &lt;rs:tag&gt;crocodiles&lt;/rs:tag&gt;
<span class="rs">       &lt;rs:key&gt;./resources/res1.txt&lt;/rs:key&gt;</span>
    &lt;/url&gt;
    &lt;url&gt;
       &lt;loc&gt;http://www.example.com/res2&lt;/loc&gt;
       &lt;lastmod&gt;2006-02-21T18:00:15+00:00&lt;/lastmod&gt;
       &lt;rs:size&gt;1123&lt;/rs:size&gt;
       &lt;rs:md5&gt;1e19bddd88e61b6b5c65a18fb63f59b4&lt;/rs:md5&gt;
       &lt;rs:tag&gt;fish&lt;/rs:tag&gt;
<span class="rs">       &lt;rs:key&gt;./resources/res2.txt&lt;/rs:key&gt;</span>
    &lt;/url&gt;
    &lt;url&gt;
       &lt;loc&gt;http://www.example.com/res3&lt;/loc&gt;
       &lt;lastmod&gt;2007-03-23T18:00:15+00:00&lt;/lastmod&gt;
       &lt;rs:size&gt;769234&lt;/rs:size&gt;
       &lt;rs:md5&gt;d41d8cd98f00b204e9800998ecf8427e&lt;/rs:md5&gt;
       &lt;rs:tag&gt;humans&lt;/rs:tag&gt;
<span class="rs">       &lt;rs:key&gt;./resources/res3.txt&lt;/rs:key&gt;</span>
    &lt;/url&gt;

&lt;/urlset&gt;
    
</pre>
<p class="backtotop">
    <a href="#top">Back to top</a>
</p>
        <!-- Resource Transfer -->
        <h2>
            <a name="resource_transfer_override" id="resource_transfer_override"></a>6. Resource Transfer Override
        </h2>

        <p>HTTP GET is the default Resource Transfer mechanism used by the Destination to update its holdings to reflect a change in a Resource at the Source. This behavior can be overridden by specifying alternate access URIs or alternate protocols and endpoints.</p>
        
        <h3>6.1 Resource Transfer Override in Sitemap Inventory</h3>

<pre>
&lt;urlset xmlns=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;
        xmlns:rs=&quot;http://resourcesync.org/ns/&quot;
        xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot;&gt;
    &lt;url&gt; 
        &lt;loc&gt;http://dbpedia.org/resource/Paris&lt;/loc&gt; 
        &lt;lastmod&gt;2012-05-08T19:59:57Z&lt;/lastmod&gt; 
        &lt;rs:eventtype&gt;updated&lt;/rs:eventtype&gt;
<span class="rs">        &lt;rs:access&gt;
            &lt;atom:link rel=&quot;alternate&quot;&gt;http://dbpedia.org/data/Paris.rdf&lt;/atom:link&gt;            
        &lt;/rs:access&gt;</span>
    &lt;/url&gt;
&lt;urlset&gt;
</pre>        
        
        <h3>6.2 Resource Transfer Override in Dump</h3>

<pre>
&lt;urlset xmlns=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;
        xmlns:rs=&quot;http://resourcesync.org/ns/&quot;
        xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot;&gt;
    &lt;url&gt; 
        &lt;loc&gt;http://dbpedia.org/resource/Paris&lt;/loc&gt; 
        &lt;lastmod&gt;2012-05-08T19:59:57Z&lt;/lastmod&gt; 
        &lt;rs:eventtype&gt;updated&lt;/rs:eventtype&gt;
<span class="rs">        &lt;rs:access&gt;
            &lt;atom:link rel=&quot;alternate&quot;&gt;http://dbpedia.org/data/Paris.rdf&lt;/atom:link&gt;            
        &lt;/rs:access&gt;
        &lt;rs:key&gt;./data/Paris.rdf&lt;/rs:key&gt;</span>
    &lt;/url&gt;
&lt;urlset&gt;
</pre>        

        
        <h3>6.3 Resource Transfer Override in Changeset</h3>

<span class="todo"><br />Q - Simeon - The OAI example seems a bit fuzzy in that the endpoint and protocol elements are just next to each other and hence rather loosely tied. Would it be better to simply define an oai-endpoint and omit the rel=protocol part?</span>
        
<span class="todo"><br />Q - Simeon - Should the example with alternate types use the type="mime/type" attribute of atom:link?</span>
        
<pre>
&lt;changeset xmlns=&quot;http://resourcesync.org/ns/&quot;
        xmlns:rs=&quot;http://resourcesync.org/ns/&quot;
        xmlns:sm=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;&gt;
    &lt;sm:url&gt;
        &lt;sm:loc&gt;http://my.oairepo.org/oai&lt;/sm:loc&gt; 
        &lt;sm:lastmod&gt;2012-05-08T19:59:57Z&lt;/sm:lastmod&gt; 
        &lt;rs:eventtype&gt;updated&lt;/rs:eventtype&gt; 
<span class="rs">        &lt;rs:access&gt; 
          &lt;atom:link rel=&quot;endpoint&quot;&gt;http://my.oairepo.org/oai&lt;/atom:link&gt; 
          &lt;atom:link rel=&quot;protocol&quot;&gt;http://www.openarchives.org/OAI/ 
            openarchivesprotocol.html&lt;/atom:link&gt; 
        &lt;/rs:access&gt;</span>
    &lt;/sm:url&gt;
    &lt;sm:url&gt;
        &lt;sm:loc&gt;http://dbpedia.org/resource/Paris&lt;/sm:loc&gt; 
        &lt;sm:lastmod&gt;2010-05-08T19:59:57Z&lt;/sm:lastmod&gt; 
        &lt;rs:eventtype&gt;updated&lt;/rs:eventtype&gt;
<span class="rs">        &lt;rs:access&gt;
            &lt;atom:link rel=&quot;alternate&quot;&gt;http://dbpedia.org/data/Paris.rdf&lt;/atom:link&gt;  
            &lt;atom:link rel=&quot;alternate&quot;&gt;http://dbpedia.org/data/Paris.nt&lt;/atom:link&gt; 
        &lt;/rs:access&gt;</span>
    &lt;/sm:url&gt;
    &lt;sm:url&gt;
        &lt;sm:loc&gt;http://flickr.org/photos/large.jp&lt;/sm:loc&gt; 
        &lt;sm:lastmod&gt;2009-05-08T19:59:57Z&lt;/sm:lastmod&gt; 
        &lt;rs:eventtype&gt;updated&lt;/rs:eventtype&gt; 
<span class="rs">        &lt;rs:access&gt; 
          &lt;atom:link rel=&quot;alternate&quot;&gt;http://farm1.flickr.com/user1/photos/asdfaslj.jp&lt;/atom:link&gt; 
        &lt;/rs:access&gt;</span>
    &lt;/sm:url&gt;
    &lt;sm:url&gt;
        &lt;sm:loc&gt;http://images.org/photos/image.jp&lt;/sm:loc&gt; 
        &lt;sm:lastmod&gt;2008-05-08T19:59:57Z&lt;/sm:lastmod&gt; 
        &lt;rs:eventtype&gt;updated&lt;/rs:eventtype&gt; 
<span class="rs">        &lt;rs:access&gt; 
          &lt;atom:link rel=&quot;alternate&quot;&gt;http://user1@http://images.org/photos/image.jp&lt;/atom:link&gt; 
        &lt;/rs:access&gt;</span>
    &lt;/sm:url&gt;
&lt;/changeset&gt;    
</pre>        

        <p class="date">
            Last Updated: 2012-06-11
        </p>
        </div><!-- closes #maincontent -->
        
        <!-- closes #container -->
        <div id="footer">
            <p class="rs">
This page is provided under the <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Attribution-ShareAlike License (version 3.0) license</a>.
            </p>
        </div>
    </body>
</html>
